---
ms.openlocfilehash: ca1f677bd38876befee833fcedd10388a71aecf4
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 02/05/2022
ms.locfileid: "138053112"
---
<a name="agent-base"></a>agent-base
==========
### <a name="turn-a-function-into-an-httpagenthttpagent-instance"></a>Conversión de una función en una instancia de [`http.Agent`][http.Agent]
[![Estado de compilación](https://github.com/TooTallNate/node-agent-base/workflows/Node%20CI/badge.svg)](https://github.com/TooTallNate/node-agent-base/actions?workflow=Node+CI)

Este módulo proporciona un generador `http.Agent`. Es decir, se envía una función de devolución de llamada asincrónica y se devuelve una nueva instancia de `http.Agent` que invocará la función de devolución de llamada especificada al enviar solicitudes HTTP salientes.

#### <a name="some-subclasses"></a>Algunas subclases:

Aquí tiene algunos usos interesantes más de `agent-base`.
Envíe una solicitud de incorporación de cambios para enumerar el suyo.

 * [`http-proxy-agent`][http-proxy-agent]: una implementación del proxy `http.Agent` HTTP(s) para puntos de conexión HTTP
 * [`https-proxy-agent`][https-proxy-agent]: una implementación del proxy `http.Agent` HTTP(s) para puntos de conexión HTTPS
 * [`pac-proxy-agent`][pac-proxy-agent]: una implementación del proxy `http.Agent` de archivo PAC para HTTP y HTTPS
 * [`socks-proxy-agent`][socks-proxy-agent]: una implementación del proxy `http.Agent` de SOCKS para HTTP y HTTPS


<a name="installation"></a>Instalación
------------

Instalación con `npm`:

``` bash
$ npm install agent-base
```


<a name="example"></a>Ejemplo
-------

Este es un ejemplo mínimo en el que se crea una nueva conexión de `net.Socket` al servidor para cada solicitud HTTP (es decir, el equivalente de la opción `agent: false`):

```js
var net = require('net');
var tls = require('tls');
var url = require('url');
var http = require('http');
var agent = require('agent-base');

var endpoint = 'http://nodejs.org/api/';
var parsed = url.parse(endpoint);

// This is the important part!
parsed.agent = agent(function (req, opts) {
  var socket;
  // `secureEndpoint` is true when using the https module
  if (opts.secureEndpoint) {
    socket = tls.connect(opts);
  } else {
    socket = net.connect(opts);
  }
  return socket;
});

// Everything else works just like normal...
http.get(parsed, function (res) {
  console.log('"response" event!', res.headers);
  res.pipe(process.stdout);
});
```

También se admite la devolución de una promesa o el uso de una función `async`:

```js
agent(async function (req, opts) {
  await sleep(1000);
  // etc…
});
```

Devuelva otra instancia de `http.Agent` para "trasladar" la responsabilidad de esa solicitud HTTP al agente:

```js
agent(function (req, opts) {
  return opts.secureEndpoint ? https.globalAgent : http.globalAgent;
});
```


<a name="api"></a>API
---

## <a name="agentfunction-callback-object-options--httpagent"></a>Agent(Function callback[, Object options]) → [http.Agent][]

Crea un `http.Agent` base que ejecutará la función de devolución de llamada `callback` para cada solicitud HTTP para la que se usa `agent`. La función de devolución de llamada es responsable de crear una instancia de `stream.Duplex` de algún tipo que se usará como socket subyacente en la solicitud HTTP.

El objeto `options` acepta las siguientes propiedades:

  * `timeout` - Número: tiempo de espera para la función `callback()` en milisegundos. El valor predeterminado es Infinito (opcional).

La función de devolución de llamada debe tener la siguiente firma:

### <a name="callbackhttpclientrequest-req-object-options-function-cb--undefined"></a>callback(http.ClientRequest req, Object options, Function cb) → undefined

Se puede acceder a la solicitud de cliente `req` para leer los encabezados de solicitud y la ruta de acceso, etc. El objeto `options` contiene las opciones que se pasan a la función de llamada `http.request()`/`https.request()`, y tiene el formato adecuado para pasar directamente a `net.connect()`/`tls.connect()`, a menos que quiera que se crea un socket. Pase el socket creado a la función de devolución de llamada `cb` una vez creada para que continúe la solicitud HTTP.

Si se usa el módulo `https` para invocar la solicitud HTTP, la propiedad `secureEndpoint` de `options` _se establecerá en `true`_ .


<a name="license"></a>Licencia
-------

(La licencia MIT)

Copyright (c) 2013 Nathan Rajlich &lt;nathan@tootallnate.net&gt;

Se concede permiso libre de cargos a cualquier persona que obtenga una copia de este software y de los archivos de documentación asociados (el "software") para utilizar el software sin restricciones, lo que incluye, a título enunciativo y no limitativo, derechos para usar, copiar, modificar, combinar, publicar, distribuir, sublicenciar o vender copias del software, así como permitir hacerlo a las personas a las que se proporcione el software, siempre que se cumplan las siguientes condiciones:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

EL SOFTWARE SE PROPORCIONA "TAL CUAL", SIN NINGÚN TIPO DE GARANTÍA EXPLÍCITA O IMPLÍCITA INCLUIDAS, SIN LIMITACIÓN, LAS GARANTÍAS DE COMERCIABILIDAD, IDONEIDAD PARA UN DETERMINADO FIN Y AUSENCIA DE INFRACCIÓN.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

[http-proxy-agent]: https://github.com/TooTallNate/node-http-proxy-agent
[https-proxy-agent]: https://github.com/TooTallNate/node-https-proxy-agent
[pac-proxy-agent]: https://github.com/TooTallNate/node-pac-proxy-agent
[socks-proxy-agent]: https://github.com/TooTallNate/node-socks-proxy-agent
[http.Agent]: https://nodejs.org/api/http.html#http_class_http_agent
