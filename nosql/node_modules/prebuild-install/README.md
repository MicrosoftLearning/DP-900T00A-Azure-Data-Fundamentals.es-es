---
ms.openlocfilehash: 50690c00791b1f6ca1d585c1fb653f0ec4794578
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052661"
---
# <a name="prebuild-install"></a>prebuild-install

> **Una herramienta de línea de comandos para instalar fácilmente archivos binarios creados previamente para varias versiones de Node.js & Electron en una plataforma específica.**
> De manera predeterminada, descarga archivos binarios creados previamente desde una versión de GitHub.

[![npm](https://img.shields.io/npm/v/prebuild-install.svg)](https://www.npmjs.com/package/prebuild-install)
![Versión del nodo](https://img.shields.io/node/v/prebuild-install.svg)
[![Prueba](https://github.com/prebuild/prebuild-install/actions/workflows/test.yml/badge.svg)](https://github.com/prebuild/prebuild-install/actions/workflows/test.yml)
[![david](https://david-dm.org/prebuild/prebuild-install.svg)](https://david-dm.org/prebuild/prebuild-install)
[![js-standard-style](https://img.shields.io/badge/code%20style-standard-brightgreen.svg)](http://standardjs.com/)

## <a name="note"></a>Nota

**En lugar de [`prebuild`](https://github.com/prebuild/prebuild) emparejado con [`prebuild-install`](https://github.com/prebuild/prebuild-install), se recomienda [`prebuildify`](https://github.com/prebuild/prebuildify) emparejado con [`node-gyp-build`](https://github.com/prebuild/node-gyp-build).**

Con `prebuildify`, todos los archivos binarios creados previamente se envían dentro del paquete que se publica en npm, lo que significa que no es necesario un paso de descarga independiente, como se encuentra en `prebuild`. La ironía de este enfoque es que es más rápido descargar todos los archivos binarios creados previamente para cada plataforma cuando se agrupan, que descargar un único archivo binario creado previamente como un script de instalación.

Ventajas:

1. No hay ningún paso de descarga adicional, lo que hace que sea más confiable y rápido de instalar.
2. Admite el cambio local de las versiones en tiempo de ejecución y el uso de la misma instalación entre Node.js y Electron. La reinstalación o recompilación no son necesarias, ya que todos los archivos binarios creados previamente están en el tarball de npm y el correcto se selecciona en tiempo de ejecución.
3. La dependencia en tiempo de ejecución `node-gyp-build` no tiene dependencias y permanecerá así, ya que la introducción de dependencias invalidaría el tiempo de instalación más corto.
4. Los archivos binarios creados previamente funcionan incluso si los scripts de instalación de npm están deshabilitados.
5. La suma de comprobación del paquete npm también cubre los archivos binarios creados previamente.

Desventajas:

1. El paquete npm instalado tiene un tamaño más grande en el disco. El uso de [Node-API](https://nodejs.org/api/n-api.html) lo alivia, porque los archivos binarios de Node-API son independientes del entorno de ejecución y son compatibles con versiones posteriores.
2. La publicación es ligeramente más complicada, ya que `npm publish` debe realizarse después de la compilación y la captura de los archivos binarios creados previamente (normalmente en CI).

## <a name="usage"></a>Uso

Use [`prebuild`](https://github.com/prebuild/prebuild) para crear y cargar los archivos binarios creados previamente. A continuación, cambie el script de instalación package.json a:

```json
{
  "scripts": {
    "install": "prebuild-install || node-gyp rebuild"
  }
}
```

### <a name="help"></a>Ayuda

```
prebuild-install [options]

  --download    -d  [url]       (download prebuilds, no url means github)
  --target      -t  version     (version to install for)
  --runtime     -r  runtime     (Node runtime [node, napi or electron] to build or install for, default is node)
  --path        -p  path        (make a prebuild-install here)
  --token       -T  gh-token    (github token for private repos)
  --arch            arch        (target CPU architecture, see Node OS module docs, default is current arch)
  --platform        platform    (target platform, see Node OS module docs, default is current platform)
  --tag-prefix <prefix>         (github tag prefix, default is "v")
  --build-from-source           (skip prebuild download)
  --verbose                     (log verbosely)
  --libc                        (use provided libc rather than system default)
  --debug                       (set Debug or Release configuration)
  --version                     (print prebuild-install version and exit)
```

Cuando `prebuild-install` se ejecuta mediante un script `npm`, las opciones `--build-from-source`, `--debug`, `--download`, `--target`, `--runtime`, `--arch` y `--platform` se pueden pasar a través de argumentos proporcionados al comando `npm`.

Como alternativa, puede establecer las variables de entorno `npm_config_build_from_source=true`, `npm_config_platform`, `npm_config_arch`, `npm_config_target` y `npm_config_runtime`.

### <a name="private-repositories"></a>Repositorios privados

`prebuild-install` admite la descarga de precompilaciones desde repositorios privados de GitHub mediante `-T <github-token>`:

```
$ prebuild-install -T <github-token>
```

Si no quiere usar el token en la CLI, puede colocarlo en `~/.prebuild-installrc`:

```
token=<github-token>
```

Como alternativa, puede especificarlo en la variable de entorno `prebuild-install_token`.

Tenga en cuenta que el uso de un token de GitHub usa la API para resolver la versión correcta, lo que significa que está sujeto al ([límite de frecuencia de GitHub](https://developer.github.com/v3/rate_limit/)).

### <a name="create-github-token"></a>Creación de un token de GitHub

Para crear un token:

- Vaya a [esta página](https://github.com/settings/tokens).
- Haga clic en el botón `Generate new token`
- Asigne un nombre al token y haga clic en el botón `Generate token`; consulte a continuación.

![prebuild-token](https://cloud.githubusercontent.com/assets/13285808/20844584/d0b85268-b8c0-11e6-8b08-2b19522165a9.png)

Los ámbitos predeterminados deberían estar bien.

### <a name="custom-binaries"></a>Archivos binarios personalizados

El usuario final puede invalidar la ubicación de descarga del archivo binario mediante variables de entorno en su archivo .npmrc.
La variable debe cumplir la máscara `% your package name %_binary_host` o `% your package name %_binary_host_mirror`. Por ejemplo:

```
leveldown_binary_host=http://overriden-host.com/overriden-path
```

Tenga en cuenta que la subruta de versión del paquete y el nombre de archivo se anexarán igualmente.
Por lo tanto, si va a instalar `leveldown@1.2.3`, la dirección URL resultante será la siguiente:

```
http://overriden-host.com/overriden-path/v1.2.3/leveldown-v1.2.3-node-v57-win32-x64.tar.gz
```

#### <a name="local-prebuilds"></a>Precompilaciones locales

Si quiere usar precompilaciones desde el sistema de archivos local, puede usar la variable .npmrc `% your package name %_local_prebuilds` para establecer una ruta de acceso a la carpeta que contiene las precompilaciones. Por ejemplo:

```
leveldown_local_prebuilds=/path/to/prebuilds
```

Esta opción buscará directamente en esa carpeta las agrupaciones creadas con `prebuild`, por ejemplo:

```
/path/to/prebuilds/leveldown-v1.2.3-node-v57-win32-x64.tar.gz
```

Las rutas de acceso no absolutas se resuelven en relación con el directorio del paquete que invoca la instalación de la precompilación, por ejemplo, para las dependencias anidadas.

### <a name="cache"></a>Cache

Todos los archivos binarios precompilados se almacenan en caché para minimizar el tráfico. Por lo tanto, primero `prebuild-install` selecciona los archivos binarios de la memoria caché y, si no encuentra ningún archivo binario, lo descargará. En función del entorno, la carpeta de caché se determina en el orden siguiente:

- `${npm_config_cache}/_prebuilds`
- `${APP_DATA}/npm-cache/_prebuilds`
- `${HOME}/.npm/_prebuilds`

## <a name="license"></a>Licencia

MIT
