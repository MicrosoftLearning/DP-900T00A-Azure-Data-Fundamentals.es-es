---
ms.openlocfilehash: 3decbdeed6f0c742925a5be9b78f5251a4c0b569
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052158"
---
# <a name="tools"></a>Herramientas

## <a name="clang-format"></a>clang-format

Las herramientas de comprobación clang-format están diseñadas para comprobar las líneas de código modificadas en comparación con las git-refs dadas.

## <a name="migration-script"></a>Script de migración

La herramienta de migración está diseñada para reducir el trabajo repetitivo en el proceso de migración. Sin embargo, el script no tiene por objetivo convertir todas las cosas por el usuario. En ocasiones, es necesario realizar correcciones menores y reconstrucciones importantes.

### <a name="how-to-use"></a>Modo de uso

Para ejecutar el script de conversión, primero asegúrese de que tiene la versión más reciente `node-addon-api` en el directorio `node_modules`.
```
npm install node-addon-api
```

A continuación, ejecute el script pasando el directorio del proyecto
```
node ./node_modules/node-addon-api/tools/conversion.js ./
```

Después de finalizar, vuelva a compilar y depurar los elementos que faltan en el script.


### <a name="quick-fixes"></a>Correcciones rápidas
Esta es la lista de aspectos que se pueden corregir fácilmente.
  1. Cambie el valor devuelto de los métodos a nulo si no devuelve valor a JavaScript.
  2. Use `.` para tener acceso al atributo o para invocar la función de miembro en Napi::Object en lugar de `->`.
  3. `Napi::New(env, value);` a 'Napi::[Type]::New(env, value);


### <a name="major-reconstructions"></a>Reconstrucción principal
La implementación de `Napi::ObjectWrap` es significativamente diferente de la de NAN. `Napi::ObjectWrap` toma un puntero al objeto ajustado y crea una referencia al objeto ajustado dentro del constructor ObjectWrap. `Napi::ObjectWrap` también asocia los métodos de instancia del objeto ajustado al módulo Javascript en lugar de a métodos estáticos como NAN.

Por lo tanto, si usa Nan::ObjectWrap en el módulo, deberá ejecutar los pasos siguientes.

  1. Convertir la función [ClassName]::New en una función de constructor que toma `Napi::CallbackInfo`. Declarar como
```
[ClassName](const Napi::CallbackInfo& info);
```
y definir como
```
[ClassName]::[ClassName](const Napi::CallbackInfo& info) : Napi::ObjectWrap<[ClassName]>(info){
  ...
}
```
De este modo, el `Napi::ObjectWrap` constructor se invocará después de crear una instancia del objeto y `Napi::ObjectWrap` puede usar el `this` puntero para crear una referencia al objeto ajustado.

  2. Mueva el código del constructor original al nuevo constructor. Elimine el constructor original.
  3. En la función de inicialización de clase, asocie métodos nativos de la siguiente manera.
```
Napi::FunctionReference constructor;

void [ClassName]::Init(Napi::Env env, Napi::Object exports, Napi::Object module) {
  Napi::HandleScope scope(env);
  Napi::Function ctor = DefineClass(env, "Canvas", {
    InstanceMethod<&[ClassName]::Func1>("Func1"),
    InstanceMethod<&[ClassName]::Func2>("Func2"),
    InstanceAccessor<&[ClassName]::ValueGetter>("Value"),
    StaticMethod<&[ClassName]::StaticMethod>("MethodName"),
    InstanceValue("Value", Napi::[Type]::New(env, value)),
  });

  constructor = Napi::Persistent(ctor);
  constructor .SuppressDestruct();
  exports.Set("[ClassName]", ctor);
}
```
  4. En la función en la que necesita desajustar ObjectWrap en NAN como `[ClassName]* native = Nan::ObjectWrap::Unwrap<[ClassName]>(info.This());`, use el puntero `this` directamente como el objeto desajustado, ya que cada instancia de ObjectWrap está asociada a una instancia de objeto única.


Si sigue teniendo problemas después de seguir esta guía, déjenos una incidencia que describa su problema e intentaremos resolverlo.
